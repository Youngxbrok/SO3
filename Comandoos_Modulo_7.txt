ğŸ’» Cliente NFS (Montaje en cliente)

ğŸ“¦ InstalaciÃ³n del cliente NFS
sudo apt update
sudo apt install nfs-common -y

ğŸ“ Montaje del recurso NFS
sudo mkdir -p /mnt/OS3
sudo mount 10.0.0.139:/srv/OS3 /mnt/OS3
ls /mnt/OS3

ğŸ” Montaje persistente con fstab
sudo nano /etc/fstab
10.0.0.139:/srv/OS3  /mnt/OS3  nfs  defaults  0  0

ğŸ§¹ Prueba del montaje persistente
sudo umount /mnt/OS3
sudo reboot
ls /mnt/OS3

ğŸ“¡ ConfiguraciÃ³n de Samba (Carpeta compartida por SMB)

ğŸ“¦ InstalaciÃ³n y activaciÃ³n del servicio Samba
sudo apt update
sudo apt install samba -y
sudo systemctl enable smbd
sudo systemctl start smbd

ğŸ“ Crear carpeta y archivos compartidos
sudo mkdir -p /srv/samba/shared
sudo chown -R nobody:nogroup /srv/samba/shared
sudo chmod -R 0775 /srv/samba/shared
sudo touch /srv/samba/shared/Adrian{1..100}.txt


ğŸ› ï¸ ConfiguraciÃ³n de Samba

sudo nano /etc/samba/smb.conf

[shared]
   comment = Share Directory
   path = /srv/samba/shared
   browseable = yes
   writeable = yes
   guest ok = no
   valid users = fernando43 

ğŸ“„ Visualizar un archivo compartido

cat /srv/samba/shared/Adrian99.txt

ğŸ‘¤ Usuarios Samba y AD (Active Directory)

ğŸ‘¥ Crear usuario local y Samba
sudo useradd -m lanegracubana
sudo passwd lanegracubana
sudo smbpasswd -a lanegracubana

ğŸ§± ConfiguraciÃ³n de Samba como Controlador de Dominio (AD-DC)

ğŸ“¦ InstalaciÃ³n de paquetes adicionales
sudo apt install samba samba-dsdb-modules samba-vfs-modules -y

ğŸ›‘ Detener servicios anteriores
sudo systemctl stop smbd nmbd
sudo systemctl disable smbd nmbd

ğŸ§° ProvisiÃ³n del dominio
sudo mv /etc/samba/smb.conf /etc/samba/smb.conf.bak
sudo samba-tool domain provision --use-rfc2307 --interactive

ğŸ“¡ ConfiguraciÃ³n DNS interna
sudo systemctl stop systemd-resolved
sudo systemctl disable systemd-resolved
sudo rm /etc/resolv.conf
echo "nameserver 127.0.0.1" | sudo tee /etc/resolv.conf

ğŸš€ Iniciar servicios de AD
sudo systemctl start samba-ad-dc
sudo systemctl enable samba-ad-dc
sudo systemctl status samba-ad-dc

ğŸ§ª ComprobaciÃ³n y diagnÃ³stico
sudo netstat -tulpn | grep :53            # Verifica DNS local
sudo samba-tool testparm                  # Revisa la configuraciÃ³n de Samba
sudo journalctl -xeu samba-ad-dc          # RevisiÃ³n de logs

ğŸ§° DepuraciÃ³n Avanzada y Respaldo

ğŸ§¹ Eliminar configuraciÃ³n anterior (si hay fallos)
sudo systemctl stop samba-ad-dc
sudo rm -rf /var/lib/samba/*
sudo rm -rf /etc/samba/smb.conf
sudo samba-tool domain provision --use-rfc2307 --interactive

ğŸ§ª VerificaciÃ³n del dominio
sudo samba-tool domain info so3.inet
sudo samba-tool dns query 10.0.0.141 so3.inet @ ALL

ğŸ‘¤ AdministraciÃ³n de usuarios en el dominio

ğŸ‘¤ Crear usuario en el dominio
sudo samba-tool user create lanegracubana
sudo samba-tool user setpassword lanegracubana

ğŸ‘¥ Agregar a grupo de administradores
sudo samba-tool group addmembers "Domain Admins" lanegracubana

ğŸ“‹ Listar usuarios
sudo samba-tool user list
